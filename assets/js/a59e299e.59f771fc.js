"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[646],{4608:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"Migrations-DB","title":"Migration DB","description":"Base centrale (Comptes)","source":"@site/docs/Migrations-DB.md","sourceDirName":".","slug":"/Migrations-DB","permalink":"/docs/Migrations-DB","draft":false,"unlisted":false,"editUrl":"https://github.com/Itaromi/pokecenterManager/tree/main/docs/docs/Migrations-DB.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Migration DB","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Architecture technique","permalink":"/docs/Architecture-technique"},"next":{"title":"S\xe9curit\xe9","permalink":"/docs/S\xe9curit\xe9"}}');var t=n(4848),i=n(8453);const o={title:"Migration DB",sidebar_position:5},c=void 0,a={},l=[{value:"Base centrale (Comptes)",id:"base-centrale-comptes",level:3},{value:"Bases secondaires (Patients &amp; Soins)",id:"bases-secondaires-patients--soins",level:3},{value:"Mise \xe0 jour automatique via scripts \ud83d\udd04",id:"mise-\xe0-jour-automatique-via-scripts-",level:3}];function d(e){const s={blockquote:"blockquote",code:"code",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h3,{id:"base-centrale-comptes",children:"Base centrale (Comptes)"}),"\n",(0,t.jsxs)(s.p,{children:["La base ",(0,t.jsx)(s.strong,{children:"centrale"})," g\xe8re les ",(0,t.jsx)(s.strong,{children:"comptes Pokecenter"}),"."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Migrations stock\xe9es dans :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"src/migration/central/\n"})}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Commandes TypeORM :"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker exec -it pokecentermanager-app-1 npm run typeorm -- migration:generate -n CreatePokemonAccountTable -d src/data-source.ts\ndocker exec -it pokecentermanager-app-1 npm run typeorm -- migration:run -d src/data-source.ts\n"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["\ud83d\udd10 Cela permet de maintenir le sch\xe9ma des ",(0,t.jsx)(s.strong,{children:"comptes Pokecenter"})," \xe0 jour."]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"bases-secondaires-patients--soins",children:"Bases secondaires (Patients & Soins)"}),"\n",(0,t.jsxs)(s.p,{children:["Chaque Pokecenter a sa ",(0,t.jsx)(s.strong,{children:"propre base"}),". Les migrations sont ",(0,t.jsx)(s.strong,{children:"ind\xe9pendantes"})," :"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Migrations stock\xe9es dans :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"src/migration/account/\n"})}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Commandes TypeORM pour les bases secondaires :"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker exec -it pokecentermanager-app-1 npm run typeorm -- migration:generate src/migration/account/NomMigration -d ormconfig.account.ts\n"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["Ces migrations concernent les ",(0,t.jsx)(s.strong,{children:"patients Pok\xe9mon"})," et leurs ",(0,t.jsx)(s.strong,{children:"soins"}),"."]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"mise-\xe0-jour-automatique-via-scripts-",children:"Mise \xe0 jour automatique via scripts \ud83d\udd04"}),"\n",(0,t.jsxs)(s.p,{children:["Un ",(0,t.jsx)(s.strong,{children:"script Node.js"})," est fourni pour appliquer les ",(0,t.jsx)(s.strong,{children:"migrations \xe0 toutes les bases secondaires"})," :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"docker exec -it pokecentermanager-app-1 node dist/scripts/UpdateAccountDBs.js\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Parcourt tous les ",(0,t.jsx)(s.strong,{children:"comptes Pokecenter"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["Applique les ",(0,t.jsx)(s.strong,{children:"migrations"})," aux bases secondaires existantes."]}),"\n",(0,t.jsxs)(s.li,{children:["Affiche un ",(0,t.jsx)(s.strong,{children:"log"})," par base : succ\xe8s ou \xe9chec."]}),"\n"]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["\ud83d\ude80 Id\xe9al pour ",(0,t.jsx)(s.strong,{children:"synchroniser les sch\xe9mas"})," des bases secondaires sans tout g\xe9rer manuellement."]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>c});var r=n(6540);const t={},i=r.createContext(t);function o(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);